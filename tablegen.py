from scipy.interpolate import interp1d
import math

from cal import setspeed

"""
whistle=1

x = [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250]
y = [442.34780831810883, 450.07334963325184, 473.4459366976496, 497.6465435931633, 524.6979838510019, 552.1620051930086, 582.6897338169694, 614.9559128675744, 649.5888631677639, 686.1321179056547, 726.8370646852775, 766.1099474798118, 812.1079779854495, 859.4040058622375, 905.6327695577975, 960.5514770605279, 1016.6113316374609, 1066.9790708645164, 1118.5092894292966, 1165.8916820644329, 1216.06518667287, 1254.1772494836111, 1292.7335744985485, 1323.7990658430704, 1345.7999886009861, 1360.4401075473208]
"""

whistle=2
x = [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250]
y = [441.4196973125527, 451.4243922821915, 472.1618377012834, 497.78424012741243, 523.5161452905702, 552.9940093320909, 583.7193666818716, 616.1542678399549, 651.685369198219, 688.1842157437491, 728.2181910007748, 768.3127396317864, 814.7566374814853, 862.4243002209626, 914.5793153097541, 969.4641835693973, 1022.6798080093797, 1078.658336694036, 1131.7315564339383, 1183.1624772716436, 1231.1152919249466, 1275.6665640108386, 1314.9240070622216, 1347.9193885424452, 1373.6396990243045, 1389.35411493682]


"""
whistle=4

x = [ 0,10,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250]

y = [441.177198445993,448.56608871706,472.653714629326,496.764800556501,525.45974064034,552.856989394778,582.20131520334,613.936171405381,652.220998973643,689.488080984316,729.028897934693,772.7003155006,818.130923668701,872.76340169776,920.557250163617,975.277818562312,1029.55312535843,1084.57221858448,1137.53719410688,1191.66168618952,1240.51785568894,1287.54582840779,1329.09899873424,1363.90798591617,1391.56787693501,1407.42005832973]
"""

f = interp1d(x, y, kind='cubic')


table=[]
n = 67.0
while (n<91):
  targetFreq = 440*math.pow(2, (n-69)/12.0 )

  print('\t', n, end='\r')

  if targetFreq <= y[0]:
    guess = 0
  elif targetFreq >= y[-1]:
    guess = x[-1]
  else:
    guess=0
    for k in range(0,251):
      error = abs(f(k)-targetFreq)
      if ( error < abs(f(guess)-targetFreq) ): guess=k
  table.append(guess)
  n+= 1/32.0

print("")

for angle in table:
  speed = setspeed(whistle, angle)
  print("{%d, %d}," % (speed, angle))

